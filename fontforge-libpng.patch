--- fontforge-20090923/gutils/gimagereadpng.c.org	2010-02-02 22:11:46.311972507 +0100
+++ fontforge-20090923/gutils/gimagereadpng.c	2010-02-02 22:12:47.331770721 +0100
@@ -220,13 +220,13 @@
     if ( (info_ptr->valid&PNG_INFO_tRNS) && info_ptr->num_trans>0 ) {
 	if ( info_ptr->color_type==PNG_COLOR_TYPE_RGB || info_ptr->color_type==PNG_COLOR_TYPE_RGB_ALPHA )
 	    base->trans = COLOR_CREATE(
-		    (info_ptr->trans_values.red>>8),
-		    (info_ptr->trans_values.green>>8),
-		    (info_ptr->trans_values.blue>>8));
+		    (info_ptr->trans_color.red>>8),
+		    (info_ptr->trans_color.green>>8),
+		    (info_ptr->trans_color.blue>>8));
 	else if ( base->image_type == it_mono )
-	    base->trans = info_ptr->trans[0];
+	    base->trans = info_ptr->trans_alpha[0];
 	else
-	    base->clut->trans_index = base->trans = info_ptr->trans[0];
+	    base->clut->trans_index = base->trans = info_ptr->trans_alpha[0];
     }
 
     row_pointers = galloc(info_ptr->height*sizeof(png_bytep));
--- fontforge-20090923/gutils/gimagewritepng.c.org	2010-02-02 22:12:59.071757326 +0100
+++ fontforge-20090923/gutils/gimagewritepng.c	2010-02-02 22:13:34.171767176 +0100
@@ -314,15 +314,15 @@
        if ( info_ptr->num_palette<=16 )
 	   png_set_packing(png_ptr);
        if ( base->trans!=-1 ) {
-	   info_ptr->trans = galloc(1);
-	   info_ptr->trans[0] = base->trans;
+	   info_ptr->trans_alpha = galloc(1);
+	   info_ptr->trans_alpha[0] = base->trans;
        }
    } else {
        info_ptr->color_type = PNG_COLOR_TYPE_RGB;
        if ( base->trans!=-1 ) {
-	   info_ptr->trans_values.red = COLOR_RED(base->trans);
-	   info_ptr->trans_values.green = COLOR_GREEN(base->trans);
-	   info_ptr->trans_values.blue = COLOR_BLUE(base->trans);
+	   info_ptr->trans_color.red = COLOR_RED(base->trans);
+	   info_ptr->trans_color.green = COLOR_GREEN(base->trans);
+	   info_ptr->trans_color.blue = COLOR_BLUE(base->trans);
        }
    }
    png_write_info(png_ptr, info_ptr);
@@ -338,7 +338,7 @@
 
     png_write_end(png_ptr, info_ptr);
 
-    if ( info_ptr->trans!=NULL ) gfree(info_ptr->trans);
+    if ( info_ptr->trans_alpha!=NULL ) gfree(info_ptr->trans_alpha);
     if ( info_ptr->palette!=NULL ) gfree(info_ptr->palette);
     png_destroy_write_struct(&png_ptr, &info_ptr);
     gfree(rows);
